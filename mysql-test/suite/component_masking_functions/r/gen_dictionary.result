#
# Compoent Masking Functions: gen_dictionary
#
INSTALL COMPONENT 'file://component_masking_functions';
CREATE TABLE
mysql.masking_dictionaries(
Dictionary VARCHAR(256) NOT NULL,
Term VARCHAR(256) NOT NULL,
UNIQUE INDEX dictionary_term_idx (Dictionary, Term),
INDEX dictionary_idx (Dictionary)
) ENGINE = InnoDB DEFAULT CHARSET=utf8mb4;
INSERT INTO mysql.masking_dictionaries VALUES("us_cities", "city1");
INSERT INTO mysql.masking_dictionaries VALUES("us_cities", "city2");
INSERT INTO mysql.masking_dictionaries VALUES("us_cities", "city3");
INSERT INTO mysql.masking_dictionaries VALUES("us_cities", "city4");
CREATE USER udftest;
SELECT masking_dictionary_term_add("single_dict", "entry");
ERROR HY000: Can't initialize function 'masking_dictionary_term_add'; Function requires MASKING_DICTIONARIES_ADMIN privilege
SELECT masking_dictionary_term_remove("single_dict", "entry");
ERROR HY000: Can't initialize function 'masking_dictionary_term_remove'; Function requires MASKING_DICTIONARIES_ADMIN privilege
SELECT masking_dictionary_remove("single_dict");
ERROR HY000: Can't initialize function 'masking_dictionary_remove'; Function requires MASKING_DICTIONARIES_ADMIN privilege
GRANT MASKING_DICTIONARIES_ADMIN ON *.* TO udftest;
SELECT masking_dictionary_term_add("single_dict", "entry");
masking_dictionary_term_add("single_dict", "entry")
1
SELECT masking_dictionary_term_add("single_dict", "entry");
masking_dictionary_term_add("single_dict", "entry")
NULL
SELECT gen_dictionary('us_cities');
gen_dictionary('us_cities')
CITY
SELECT gen_dictionary('single_dict');
gen_dictionary('single_dict')
entry
SELECT gen_dictionary('nonexistent');
gen_dictionary('nonexistent')
NULL
SELECT masking_dictionary_term_remove("single_dict", "entry");
masking_dictionary_term_remove("single_dict", "entry")
1
SELECT masking_dictionary_term_remove("single_dict", "entry");
masking_dictionary_term_remove("single_dict", "entry")
NULL
SELECT gen_dictionary('single_dict');
gen_dictionary('single_dict')
NULL
SELECT masking_dictionary_remove("us_cities");
masking_dictionary_remove("us_cities")
1
SELECT masking_dictionary_remove("us_cities");
masking_dictionary_remove("us_cities")
NULL
SELECT gen_dictionary('us_cities');
gen_dictionary('us_cities')
NULL
DROP USER udftest;
UNINSTALL COMPONENT 'file://component_masking_functions';
DROP TABLE mysql.masking_dictionaries;
