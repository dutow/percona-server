--echo #
--echo # Component Masking Functions: mask_inner
--echo #

INSTALL COMPONENT 'file://component_masking_functions';

SELECT mask_inner('This is a string', 5, 1);
SELECT mask_inner('This is a string', 1, 5);
SELECT mask_inner('This is a string', 5, 1, '#');
SELECT mask_inner(NULL, 1, 2);
SELECT mask_inner(NULL, 1, 2, '#');

--error ER_UDF_ERROR
SELECT mask_inner('This is a string', 0, 5, '');

--error ER_UDF_ERROR
SELECT mask_inner('This is a string', 0, 5, 'ab');

--error ER_UDF_ERROR
SELECT mask_inner('This is a string', 0, 5, 5);

--error ER_UDF_ERROR
SELECT mask_inner('This is a string', 'a', 5, 'a');

--error ER_UDF_ERROR
SELECT mask_inner('This is a string', 2, 'a', 'a');

--error ER_UDF_ERROR
SELECT mask_inner('This is a string', -1, 5);

--error ER_UDF_ERROR
SELECT mask_inner('This is a string', 1, -5);

SELECT mask_inner('This is a string', 1, 25);
SELECT mask_inner('This is a string', 100, 500);
SELECT mask_inner('This is a string', 9, 9, '#');

--echo # check charset of mask_inner()

SELECT CHARSET(mask_inner('abcdef', 1, 2));

SELECT mask_inner(_utf8mb4'árvíztűrő tükörfúrógép', 10, 2);
SELECT CHARSET(mask_inner(_utf8mb4'árvíztűrő tükörfúrógép', 10, 2));

SELECT CHAR_LENGTH('This is a string');
SELECT mask_inner('This is a string', 5, 1, 'ű');
SELECT mask_inner('This is a string', 0, 1, 'ű');
SELECT mask_inner('This is a string', 5, 0, 'ű');
SELECT CHAR_LENGTH(mask_inner('This is a string', 5, 1, 'ű'));

SELECT mask_inner('This is a string', 5, 1, _utf32'#');
SELECT CHAR_LENGTH(mask_inner('This is a string', 5, 1, _utf32'#'));

# BUG: upstream string handling functions can't deal with utf16/32
#SELECT mask_inner(_utf32'This is a string', 5, 1, '#');
#SELECT CHAR_LENGTH(mask_inner(_utf32'This is a string', 5, 1, '#'));
#SELECT mask_inner(_utf32'This is a string', 1, 25);

SELECT mask_inner('űűűűűűűűűűűűű', 1,1);

UNINSTALL COMPONENT 'file://component_masking_functions';
